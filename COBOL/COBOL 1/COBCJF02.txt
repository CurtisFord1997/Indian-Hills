//FILE VARS
FILE INPUT1 = CBLBOAT1.DAT
FILE OUTPUT1 = BOATRPT1.PRT

//input variables
STRING I-REC
	STRING I-LAST-NAME, I-STATE,I-BOAT-TYPE
	DOUBLE I-BOAT-COST
	STRING I-DATE
		INTEGER I-YYYY,I-MM,I-DD
	DOUBLE I-PREP-DELIVER-COST
	INTEGER I-PURCHASE TYPE, I-ACCESSORY-PACKAGE

//CALC VAR
STRING C-BOAT-TYPE, C-ACCESSORY-PACKAGE
DOUBLE C-TOTAL-COST, C-SUB-TOTAL-COST = 0, C-GT-TOTAL-COST = 0
INTEGER C-SUB-NUM-SOLD = 0, C-GT-NUM-SOLD = 0, C-PG-NUM = 0
BOOLEAN EOF = FALSE

//Heald VARS
STRING HEALD-DATA
	STRING H-BOAT-TYPE 

//OUTPUT VAR
STRING COMPANY-TITLE-NAME 
	INTEGER TITLE-MM, TITLE-DD, TITLE-YYYY, TITLE-PG
STRING DATA-LINE
	STRING DAT-LAST-NAME, DAT-STATE, 
	DOUBLE DAT-BOAT-COST
	INTEGER DAT-MM, DAT-DD, DAT-YY
	STRING DAT-ACCESSORY-PACKAGE
	DOUBLE DAT-PREP-DELIVER-COST, DAT-TOTAL-COST
	
STRING BOAT-TYPE-HEADER-LINE
	STRING BOAT-HEADER 
	
STRING BOAT-SUB-LINE
	STRING SUB-BOAT-TYPE
	INTEGER SUB-NUM-SOLD
	DOUBLE SUB-TOTAL-COST
	
STRING GRAND-TOTALS
	INTEGER GT-NUM-SOLD
	DOUBLE GT-GRAND-TOTALS
	
0000-MAIN()
	1000-INIT()
	
	DO UNTIL (EOF)
		20000-NORM()
	END-DO
	
	3000-CLOSING()
END-0000-MAIN

1000-INIT()
	OPEN INPUT INPUT1
	OPEN OUTPUT OUTPUT1
	
	PLACE SYSTEM DATE AND TIME IN: (I-DATE, I-TIME)
	
	TITLE-MM = I-MM
	TITLE-DD = I-DD
	TITLE-YYYY = I-YYYY
	
	CALL 9100-READ()
	
	H-BOAT-TYPE = I-BOAT-TYPE
	
	CALL 9200-HEADINGS()
END-1000-INIT

2000-NORM()
	IF I-BOAT-TYPE NOT = H-BOAT-TYPE
		CALL 9300-SUBTOTAL-LINE()
		
		IF (LINE >=  56)
			CALL 9200-HEADINGS
		END-IF
		
		CALL 9400-BOAT-HEADING()
	END-IF
	
	CALL 2100-CALCS()
	CALL 2200-MAINLINE()
	CALL 9100-READ()
END-2000-NORM

2100-CALCS()
	C-TOTAL-COST = I-BOAT-COST + I-PREP-DELIVER-COST
	
	
	IF (I-ACCESSORY-PACKAGE = 1)
		DAT-ACCESSORY-PACKAGE = "Electronics"
	ELSE
		IF (I-ACCESSORY-PACKAGE = 2)
			DAT-ACCESSORY-PACKAGE = "Ski Package"
		ELSE
			DAT-ACCESSORY-PACKAGE = "Finishing Package"
		END-IF
	END-IF
	
	C-SUB-NUM-SOLD += 1
	C-SUB-TOTAL-COST += C-TOTAL-COST
END-2100-CALCS
	
2200-MAINLINE()

	DAT-LAST-NAME = I-LAST-NAME
	DAT-STATE = I-STATE
	DAT-BOAT-COST = I-BOAT-COST
	DAT-MM = I-MM
	DAT-DD = I-DD
	DAT-YY = I-YYYY
	DAT-ACCESSORY-PACKAGE = C-ACCESSORY-PACKAGE
	DAT-PREP-DELIVER-COST = I-PREP-DELIVER-COST
	DAT-TOTAL-COST = C-TOTAL-COST
	
	PRINT DATA-LINE
	
	IF (LINE >=  60)
		CALL 9200-HEADINGS()
	END-IF
	
END-2200-MAINLINE()

3000-CLOSING()
	CALL SUBTOTAL-LINE()
	
	GT-NUM-SOLD = C-GT-NUM-SOLD
	GT-TOTAL-COST = C-GT-TOTAL-COST
	
	PRINT BLANK LINE
	PRINT GRAND-TOTALS
END-3000-CLOSING

91000-READ
	READ INPUT1 (I-REC)
	
	IF (NO MORE RECORDS)
		EOF = TRUE
	END-IF
	
END-9100-READ

9200-HEADINGS
	C-PG-NUM += 1
	GO TO NEW PAGE
	TITLE-PG = C-PG-NUM
	PRINT COMPANY-TITLE-LINE
	PRINT BLANK LINE
	
	PRINT COLUMB-HEADING-LINE1
	PRINT COLUMB-HEADING-LINE2
	LINE = 4
	
	CALL BOAT-HEADING
END-9200-HEADINGS

9300-SUBTOTAL-LINE()
	SUB-BOAT-TYPE = H-BOAT-TYPE
	SUB-NUM-SOLD = C-SUB-NUM-SOLD
	SUB-TOTAL-COST = C-SUB-TOTAL-COST
	
	PRINT BLANK LINE
	PRINT BOAT-SUB-LINE
	
	C-GT-NUM-SOLD += C-SUB-NUM-SOLD
	C-GT-TOTAL-COST += C-GT-TOTAL-COST
	
	C-SUB-NUM-SOLD = 0
	H-BOAT-TYPE = I-BOAT-TYPE
END-9300-SUBTOTAL-LINE

9400-BOAT-HEADING 
	BOAT-HEADER = I-BOAT-TYPE
	
	PRINT BLANK LINE
	PRINT BOAT-TYPE-HEADER-LINE
	PRINT BLANK LINE
	
	LINE += 3
END-9400-BOAT-HEADING

9500-BOAT-INTERPRET.
	SWITCH I-BOAT-TYPE
		CASE "B"
			C-BOAT-TYPE = "BASS BOAT"
		CASE "P"
			C-BOAT-TYPE = "PONTOON"
		CASE "S"
			C-BOAT-TYPE = "SKI BOAT"
		CASE "J"
			C-BOAT-TYPE = "JOHN BOAT"
		CASE "C"
			C-BOAT-TYPE = "CANOE"
		CASE "R"
			C-BOAT-TYPE = "CABIN CRUISER"
	END-SWITCH